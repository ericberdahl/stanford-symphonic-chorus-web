{{ -let '_style' (default this.style "em-tagged") }}

{{#ssc-sentence (-union (-array) this.piece) }}
    {{#if this.ref }}
        {{~ -let '_piece' (ssc-findPiece this.ref) ~}}
    {{else}}
        {{~ -let '_piece' this ~}}
    {{/if~}}

    {{~ -let '_citation' (default _piece.citation (s-concat "<em>" _piece.title "</em>")) ~}}

    {{#if (-equal? ../_style "em-tagged")}}
        {{~ -let '_composer' _piece.composer ~}}
    {{else if (-equal? ../_style "plain") }}
        {{~ -let '_composer' (s-concat _piece.composer ":") ~}}
        {{~ -let '_citation' (sanitize _citation) ~}}
    {{else}}
        {{~ -let '_composer' '' ~}}
    {{/if~}}
    {{{trim (join (-array _composer
                    this.prefix
                    _citation
                    this.suffix)
                " ") }}}
{{/ssc-sentence}}
